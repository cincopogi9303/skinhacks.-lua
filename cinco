-- Script to display a text label above player's head
-- Place this in a LocalScript inside StarterPlayerScripts

local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- Function to create the BillboardGui
local function createTextLabel(character)
    local head = character:FindFirstChild("Head") -- Find the player's head
    if head then
        -- Create a BillboardGui
        local billboardGui = Instance.new("BillboardGui")
        billboardGui.Name = "PlayerLabel"
        billboardGui.Adornee = head -- Attach it to the head
        billboardGui.Size = UDim2.new(0, 200, 0, 50) -- Set the size of the text box
        billboardGui.StudsOffset = Vector3.new(0, 2, 0) -- Offset the text above the head
        billboardGui.AlwaysOnTop = true

        -- Create the text label
        local textLabel = Instance.new("TextLabel")
        textLabel.Parent = billboardGui
        textLabel.Size = UDim2.new(1, 0, 1, 0)
        textLabel.BackgroundTransparency = 1
        textLabel.Text = player.Name -- Set the text to the player's name
        textLabel.TextColor3 = Color3.new(1, 1, 1) -- Set the text color (white)
        textLabel.TextScaled = true -- Scale the text to fit

        -- Parent the BillboardGui to the player's head
        billboardGui.Parent = head
    end
end

-- Ensure the text label is created when the character spawns
player.CharacterAdded:Connect(function(character)
    createTextLabel(character)
end)

-- For an existing character, create the label immediately
if player.Character then
    createTextLabel(player.Character)
end


local Players = game:GetService("Players")

-- Function to highlight a player
local function highlightPlayer(player)
    local character = player.Character or player.CharacterAdded:Wait()
    local highlight = Instance.new("Highlight")
    highlight.Parent = character
    highlight.OutlineColor = Color3.new(1, 0, 0) -- Red outline
    highlight.Filled = false -- Only outline

    -- Keep highlighting until the game ends
    game.Ended:Connect(function()
        highlight:Destroy()
    end)
end

-- Highlight all players on join or rejoin
Players.PlayerAdded:Connect(highlightPlayer)
for _, player in pairs(Players:GetPlayers()) do
    highlightPlayer(player)
end

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Create a remote event for client-side effects
local bulletHitEvent = ReplicatedStorage:WaitForChild("BulletHitEvent") or Instance.new("RemoteEvent")
bulletHitEvent.Name = "BulletHitEvent"

-- Function to handle bullet hits with looping
local function handleBulletHit(hitInfo)
    local player = Players:GetPlayerFromCharacter(hitInfo.Parent)
    if player then
        -- Create a beam or trail effect from the bullet's origin to the hit point
        local beam = Instance.new("Beam")
        beam.Parent = workspace
        beam.Color = Color3.new(1, 0, 0) -- Red beam
        beam.Texture = "rbxasset://textures/beam/bright"
        beam.Start = hitInfo.p
        beam.End = hitInfo.Position

        -- Add a looping effect to the beam
        local loopInterval = 0.5 -- Seconds between loops
        local loopTimer = 0
        game:GetService("RunService").Heartbeat:Connect(function(dt)
            loopTimer = loopTimer + dt
            if loopTimer >= loopInterval then
                loopTimer = loopTimer - loopInterval
                beam.End = hitInfo.Position
            end
        end)

        -- Add a timer to destroy the beam after a certain duration
        local beamLifetime = 2 -- Seconds
        game:GetService("RunService").Heartbeat:Connect(function(dt)
            beamLifetime = beamLifetime - dt
            if beamLifetime <= 0 then
                beam:Destroy()
            end
        end)

        -- Trigger the remote event on the client
        bulletHitEvent:FireClient(player, hitInfo.Position)
    end
end

-- Example: Handle bullet hits from a weapon
local weapon = -- Your weapon object here
weapon.Shoot:Connect(function()
    local bullet = -- Create your bullet object here
    bullet.Hit:Connect(handleBulletHit)
end)


